<% layout('partials/layout') %>

<div style="
  max-width:420px;
  margin:40px auto;
  background:#fff;
  padding:40px 32px;
  border-radius:16px;
  box-shadow:0 8px 24px rgba(0,0,0,.12);
">

  <h2 style="text-align:center; font-weight:700; margin-bottom:6px;">
    Crear cuenta
  </h2>
  <p style="text-align:center; color:#6b7280; margin-bottom:24px;">
    Completa tus datos para registrarte.
  </p>

  <form method="POST" action="/register">

    <label>Nombre</label>
    <input id="nombre" name="nombre" type="text"
           class="input" required minlength="1"
           placeholder="Tu nombre">
    <small id="msg-nombre" class="msg"></small>

    <label style="margin-top:16px;">Apellido</label>
    <input id="apellido" name="apellido" type="text"
           class="input" required minlength="1"
           placeholder="Tu apellido">
    <small id="msg-apellido" class="msg"></small>

    <label style="margin-top:16px;">Cédula</label>
    <input id="cedula" name="cedula" type="text"
           class="input" maxlength="10"
           placeholder="10 dígitos">
    <small id="msg-cedula" class="msg"></small>

    <label style="margin-top:16px;">Email</label>
    <input id="email" name="email" type="email"
           class="input" placeholder="ejemplo@correo.com">
    <small id="msg-email" class="msg"></small>

    <label style="margin-top:16px;">Teléfono</label>
    <input id="telefono" name="telefono" type="text"
           class="input" maxlength="10"
           placeholder="10 dígitos">
    <small id="msg-telefono" class="msg"></small>

    <label style="margin-top:16px;">Contraseña</label>
    <input id="password" name="password" type="password"
           class="input" minlength="6" placeholder="Mínimo 6 caracteres">
    <small id="msg-pass" class="msg"></small>

    <button id="btn-register" class="btn-primary"
            style="margin-top:28px; width:100%; font-size:16px;">
      Registrar
    </button>

  </form>

  <p style="text-align:center; margin-top:18px;">
    ¿Ya tienes cuenta?
    <a href="/login" style="color:#2563eb;">Inicia sesión</a>
  </p>
</div>

<style>
  .input {
    width:100%;
    padding:12px 14px;
    border:1px solid #e5e7eb;
    border-radius:10px;
    margin-top:4px;
    font-size:15px;
    outline:none;
  }
  .input:focus {
    border-color:#2563eb;
    box-shadow:0 0 0 3px rgba(37,99,235,0.15);
  }
  .msg {
    color:#e11d48;
    font-size:13px;
    height:14px;
    margin-top:4px;
    display:block;
  }
</style>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const nombre   = document.getElementById("nombre");
  const apellido = document.getElementById("apellido");
  const cedula   = document.getElementById("cedula");
  const email    = document.getElementById("email");
  const telefono = document.getElementById("telefono");
  const pass     = document.getElementById("password");
  const btn      = document.getElementById("btn-register");

  const msgN  = document.getElementById("msg-nombre");
  const msgA  = document.getElementById("msg-apellido");
  const msgC  = document.getElementById("msg-cedula");
  const msgE  = document.getElementById("msg-email");
  const msgT  = document.getElementById("msg-telefono");
  const msgP  = document.getElementById("msg-pass");

  nombre.addEventListener("input", () => {
    msgN.textContent = nombre.value.trim().length < 1 ? "Ingrese su nombre" : "";
  });

  apellido.addEventListener("input", () => {
    msgA.textContent = apellido.value.trim().length < 1 ? "Ingrese su apellido" : "";
  });

  cedula.addEventListener("input", () => {
    const ok = /^[0-9]{10}$/.test(cedula.value);
    msgC.textContent = ok ? "" : "Debe tener 10 números";
  });

  email.addEventListener("input", () => {
    const ok = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.com$/.test(email.value);
    msgE.textContent = ok ? "" : "Debe ser email válido @xxxx.com";
  });

  telefono.addEventListener("input", () => {
    const ok = /^[0-9]{10}$/.test(telefono.value);
    msgT.textContent = ok ? "" : "Debe tener 10 números";
  });

  // ✅ ÚNICO CAMBIO: BLOQUEAR ESPACIOS EN LA CONTRASEÑA EN TIEMPO REAL
  pass.addEventListener("input", () => {
    if (pass.value.includes(" ")) {
      pass.value = pass.value.replace(/\s+/g, "");
    }

    msgP.textContent = pass.value.length < 6
      ? "Mínimo 6 caracteres (sin espacios)"
      : "";
  });

  document.querySelector("form").addEventListener("submit", (e) => {
    if (
      msgN.textContent ||
      msgA.textContent ||
      msgC.textContent ||
      msgE.textContent ||
      msgT.textContent ||
      msgP.textContent
    ) {
      e.preventDefault();
      alert("Por favor completa correctamente todos los campos.");
    }
  });

});
</script>
