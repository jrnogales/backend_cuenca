<% layout('partials/layout') %>

<a href="/admin" class="btn">â† Volver</a>
<h2>ğŸ’ Paquetes</h2>

<div class="card" style="margin-bottom:16px">
  <h3>Nuevo paquete</h3>
  <form method="POST" action="/admin/paquetes/save"
        style="display:grid;grid-template-columns:repeat(5,1fr);gap:8px">

    <input name="codigo"       placeholder="CÃ³digo" required>
    <input name="titulo"       placeholder="TÃ­tulo" required>

    <input name="precio_adulto" placeholder="Precio adulto"
           type="number" step="0.01" min="0" required>

    <input name="precio_nino"   placeholder="Precio niÃ±o"
           type="number" step="0.01" min="0" required>

    <input name="imagen"       placeholder="URL imagen">

    <textarea name="descripcion" placeholder="DescripciÃ³n"
              style="grid-column:1/6"></textarea>

    <button class="btn-primary" style="grid-column:1/2">Guardar</button>
  </form>
</div>

<div class="card">
  <table class="table">
    <thead>
      <tr>
        <th>#</th>
        <th>CÃ³digo</th>
        <th>TÃ­tulo</th>
        <th>Adulto</th>
        <th>NiÃ±o</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <% paquetes.forEach(p => { %>
        <tr>
          <td><%= p.id %></td>
          <td><%= p.codigo %></td>
          <td><%= p.titulo %></td>
          <td>$<%= Number(p.precio_adulto).toFixed(2) %></td>
          <td>$<%= Number(p.precio_nino).toFixed(2) %></td>
          <td>
            <details>
              <summary>Editar</summary>

              <form method="POST" action="/admin/paquetes/save"
                    style="display:grid;grid-template-columns:repeat(5,1fr);gap:8px;margin-top:8px">

                <input type="hidden" name="id" value="<%= p.id %>">
                <input name="codigo" value="<%= p.codigo %>" required>
                <input name="titulo" value="<%= p.titulo %>" required>
                <input name="precio_adulto" type="number" step="0.01" min="0"
                       value="<%= p.precio_adulto %>" required>
                <input name="precio_nino"   type="number" step="0.01" min="0"
                       value="<%= p.precio_nino %>" required>
                <input name="imagen" value="<%= p.imagen || '' %>">
                <textarea name="descripcion" style="grid-column:1/6"><%= p.descripcion || '' %></textarea>

                <button class="btn-primary" style="grid-column:1/2">Actualizar</button>
              </form>
            </details>

            <form method="POST"
                  action="/admin/paquetes/delete/<%= p.id %>"
                  onsubmit="return confirm('Â¿Seguro que deseas eliminar este paquete?\nEsta acciÃ³n es irreversible.');"
                  style="margin-top:6px">
              <button class="btn-danger" style="width:100%">ğŸ—‘ Eliminar</button>
            </form>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>
