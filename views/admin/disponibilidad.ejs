<% layout('partials/layout') %>

<a href="/admin" class="btn">← Volver</a>
<h2>📅 Disponibilidad</h2>

<div class="card" style="margin-bottom:16px">
  <h3>Configurar cupos por fecha</h3>
  <form method="POST" action="/admin/disponibilidad/save" style="display:flex;gap:8px;flex-wrap:wrap">
    <select name="paquete_id" required>
      <option value="">— Paquete —</option>
      <% paquetes.forEach(p => { %>
        <option value="<%= p.id %>"><%= p.titulo %> (<%= p.codigo %>)</option>
      <% }) %>
    </select>
    <input type="date" name="fecha" required>
    <input type="number" min="0" name="cupos_totales" placeholder="Cupos totales" required>
    <button class="btn-primary">Guardar</button>
  </form>
</div>

<div class="card">
  <table class="table">
    <thead><tr><th>Fecha</th><th>Paquete</th><th>Totales</th><th>Reservados</th><th>Restantes</th></tr></thead>
    <tbody>
      <% disp.forEach(d => { %>
        <tr>
          <td><%= String(d.fecha).slice(0,10) %></td>
          <td><%= d.titulo %></td>
          <td><%= d.cupos_totales %></td>
          <td><%= d.cupos_reservados %></td>
          <td><%= (Number(d.cupos_totales)-Number(d.cupos_reservados)) %></td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>
